---
output: 
  github_document:
    fig_width: 7.5
    fig_height: 6
  html_preview: false
editor_options: 
  chunk_output_type: console
---
rayvista
=========================================================
<p align="center">
<img src="man/figures/hex_HR.png" width="30%" />
</p>

Introduction
--------

**rayvista** is an R package providing a small plugin for the fabulous 
[{rayshader}](https://github.com/tylermorganwall/rayshader) package. It provides
a single main function `plot_3d_vista` which allows the user to create a 3D 
visualisation of any location on earth. It is reliant on two other brilliant 
packages: [{maptiles}](https://github.com/riatelab/maptiles) and 
[{elevatr}](https://github.com/jhollist/elevatr). The many available map styles
from {maptiles} can be easily overlaid on top of elevation data from {elevatr} 
to create the 3D scene or vista :wink:

An [{rgl}](https://github.com/cran/rgl) window is opened which displays the vista
and the user may then interact with it using a selection of functions provided
by {rayshader} including: `render_snapshot`, `render_highquality`, 
`render_compass`, etc. see the [rayshader function reference](https://www.rayshader.com/reference/index.html)
for more details...

This package is in its early days so there will no doubt be some issues. Please
feel free to submit an [issue](https://github.com/h-a-graham/rayvista/issues) 
or start up a [discussion]()


Installation
------------

``` r
# install.packages("devtools")
devtools::install_github("h-a-graham/rayvista")
```

Functions
------------
For now there are only two exported functions:

`plot_3d_vista` which generates the 3D scene

`render_attributes` applies data attribute labels to rgl window

Examples
------------
```{r setup, include = FALSE}
library(knitr)
library(rgl)
knit_hooks$set(rgl = hook_rgl)
knitr::opts_chunk$set(
  fig.path = "man/figures/",
  cache = TRUE
)
set.seed(1001)
```


```{r BlaBheinn, message=FALSE, warning=FALSE, results='hide'}
# Make sure to lod rayshader so you can interact with the {rgl} window after 
# running `plot_3d_vista()`
library(rayshader) 
library(rayvista)

.lat <- 57.21956608144513
.long <- -6.092690805001252

cuillins <- plot_3d_vista(lat = .lat, long = .long, phi=30)

coords <- get_coords_3857(lat=.lat, lon =.lon )

render_label(heightmap= cuillins, text='Bla Bheinn: 928 m', lat = coords$lat,
             long=coords$long, extent = attr(cuillins, 'extent'),altitude=300, 
             textcolor='black',freetype=F, zscale = 2)

render_compass()
render_snapshot(clear=TRUE)

```


```{r GoraBolshayaUdina, message=FALSE, warning=FALSE, results='hide'}

plot_3d_vista(lat=55.757338, long=160.526712, phi=20)

render_depth(focus=0.4, focallength = 0.6,clear=TRUE)
```


```{r Yosemite, message=FALSE, warning=FALSE, results='hide'}
plot_3d_vista(lat=37.742501, long=-119.558298, zscale=5, zoom=0.5, theta=-65,
              phi=25)

render_highquality(lightdirection = c(60,120, 240),
                   lightaltitude=c(90,25, 12),
                   lightintensity=c(100, 500, 450),
                   lightcolor = c("white", "#FF9956", "#FF79E7"),
                   clear=TRUE)
```


